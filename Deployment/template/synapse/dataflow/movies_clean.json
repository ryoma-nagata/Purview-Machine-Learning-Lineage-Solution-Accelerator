{
  "name": "movies_clean",
  "properties": {
      "folder": {
          "name": "movies_delta"
      },
      "type": "MappingDataFlow",
      "typeProperties": {
          "sources": [
              {
                  "linkedService": {
                      "referenceName": "syn-analyticsdemo5rc3-WorkspaceDefaultStorage",
                      "type": "LinkedServiceReference"
                  },
                  "name": "source1"
              }
          ],
          "sinks": [
              {
                  "linkedService": {
                      "referenceName": "syn-analyticsdemo5rc3-WorkspaceDefaultStorage",
                      "type": "LinkedServiceReference"
                  },
                  "name": "sink1"
              }
          ],
          "transformations": [
              {
                  "name": "clean"
              }
          ],
          "script": "source(output(\n\t\tmovies as integer,\n\t\tTitle as string,\n\t\tgenresgenregenre as string,\n\t\tYEAR as integer,\n\t\tRating as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'delta',\n\tfileSystem: 'data',\n\tfolderPath: 'bronze/movies_delta') ~> source1\nsource1 filter(YEAR>0) ~> clean\nclean sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'delta',\n\tfileSystem: 'data',\n\tfolderPath: 'silver/movies_delta',\n\ttruncate:true,\n\tmergeSchema: false,\n\tautoCompact: false,\n\toptimizedWrite: false,\n\tvacuum: 0,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1"
      }
  }
}